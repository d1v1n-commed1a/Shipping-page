<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>ì˜¨ë¼ì¸ ì‡¼í•‘ëª° ê³ ê° ì£¼ë¬¸ ì²˜ë¦¬ í”„ë¡œê·¸ë¨</title>
  <style>
    body{
      font-family: system-ui, sans-serif;
      line-height: 1.6;
      margin: 0px;
      padding: 0px;
    }
    .layout{
      display: grid;
      grid-template-areas:
        "header header"
        "content sidebar";
      grid-template-columns: 1fr 300px;
      grid-template-rows: 60px 1fr;
      height: 100vh;
    }
    header{
      grid-area: header;
      background: #1e7a3b;
      color: rgb(255, 255, 255);
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 0 20px;
    }
    aside{
      grid-area: sidebar;
      background: #ecf0f1;
      display: flex;
      flex-direction: column;
      gap: 10px;
      padding:20px;
      font-size: 14px;
    }
    main{
      max-width: 1220px;
      position: relative;
      padding: 20px;
      padding-top: 0px;
      font-size: 90%;
      align-items: center;
    }
    .sticky{
      position: sticky;
      top: 20px;
    }
    .card-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(180px, 1fr));
      gap: 20px;
    }
    .card {
      background: #79b861;
      color: white;
      padding: 16px;
      border-radius: 8px;
      display: flex;
      flex-direction: column;
      justify-content: space-between;
    }
    img {
      max-width: fit-content;
      border-radius: 8px;
    }
  </style>
</head>
<body>
  <div class="layout">
    <header>
      <h2><strong>ğŸ¥’ì˜¤ì´ ë§ˆíŠ¸</strong></h2>
      <nav><small>Log in | Sign in</small></nav>
    </header>

    <main>
      <h3>ğŸ“Œ ëª¨ë“  ì˜¤ì´ì˜ ê°€ê²©ì„ ë™ê²°í•©ë‹ˆë‹¤.</h3>
      <div class="card-grid">
        <div class="card">
          <div style="align-self: center; font-size: 15px; color: #255014;"><strong>ì‹±ì‹±í•œ ì˜¤ì´</strong></div><hr>
          <img src="media/strong.jpg" alt="ë¨¹ìœ¼ë©´ íŠ¼íŠ¼í•´ì§€ëŠ” ì˜¤ì´"/>
          <p>5,000ì› /kg</p>
          <form class="orderForm" data-name="ì‹±ì‹±í•œ ì˜¤ì´" data-price="5000" data-stock="10" style="align-self: center;">
            <p>
              <label>êµ¬ë§¤ ìˆ˜ëŸ‰</label>
              <input class="orderAmount" name="orderAmount" type="number" placeholder="ì˜ˆ: 1" />
            </p>
            <button type="submit">ì¥ë°”êµ¬ë‹ˆì— ë‹´ê¸°</button>
          </form>
        </div>

        <div class="card">
          <div style="align-self: center; font-size: 15px; color: #255014;"><strong>í• ë¨¸ë‹ˆê°€ í…ƒë°­ì—ì„œ ê¸°ë¥¸ ì˜¤ì´</strong></div><hr>
          <img src="media/grandma.jpg" alt="í• ë¨¸ë‹ˆì˜ ë¹„ë°€ìŠ¤ëŸ¬ìš´ ì˜¤ì´"/>
          <p>5,000ì› /kg</p>
          <form class="orderForm" data-name="í• ë¨¸ë‹ˆê°€ í…ƒë°­ì—ì„œ ê¸°ë¥¸ ì˜¤ì´" data-price="5000" data-stock="10" style="align-self: center;">
            <p>
              <label>êµ¬ë§¤ ìˆ˜ëŸ‰</label>
              <input class="orderAmount" name="orderAmount" type="number" placeholder="ì˜ˆ: 1" />
            </p>
            <button type="submit">ì¥ë°”êµ¬ë‹ˆì— ë‹´ê¸°</button>
          </form>
        </div>

        <div class="card">
          <div style="align-self: center; font-size: 15px; color: #255014;"><strong>ì•½ê°„ ìª¼ê¸€í•´ì§„ ì˜¤ì´</strong></div><hr>
          <img src="media/ugly.jpg" alt="ëª»ìƒê¸´ ì˜¤ì´"/>
          <p>5,000ì› /kg</p>
          <form class="orderForm" data-name="ì•½ê°„ ìª¼ê¸€í•´ì§„ ì˜¤ì´" data-price="5000" data-stock="10" style="align-self: center;">
            <p>
              <label>êµ¬ë§¤ ìˆ˜ëŸ‰</label>
              <input class="orderAmount" name="orderAmount" type="number" placeholder="ì˜ˆ: 1" />
            </p>
            <button type="submit">ì¥ë°”êµ¬ë‹ˆì— ë‹´ê¸°</button>
          </form>
        </div>

        <div class="card">
          <div style="align-self: center; font-size: 15px; color: #255014;"><strong>ì˜¤ì´(ê³¼ê±°í˜•)</strong></div><hr>
          <img src="media/pickle.jpg" alt="í”¼í´ì´ ë˜ì–´ë²„ë¦° ì˜¤ì´"/>
          <p>5,000ì› /kg</p>
          <form class="orderForm" data-name="ì˜¤ì´(ê³¼ê±°í˜•)" data-price="5000" data-stock="10" style="align-self: center;">
            <p>
              <label>êµ¬ë§¤ ìˆ˜ëŸ‰</label>
              <input class="orderAmount" name="orderAmount" type="number" placeholder="ì˜ˆ: 1" />
            </p>
            <button type="submit">ì¥ë°”êµ¬ë‹ˆì— ë‹´ê¸°</button>
          </form>
        </div>
      </div>
    </main>

    <aside>
      <div>Membership</div>
      <select id="membership">
        <option value="">-- ì„ íƒ --</option>
        <option value="VIP">VIP</option>
        <option value="Gold">Gold</option>
        <option value="Silver">Silver</option>
      </select>

      <div style="margin-top: 12px;">ë°°ì†¡ ë°©ë²•</div>
      <select id="shippingOption">
        <option value="">-- ì„ íƒ --</option>
        <option value="fast">Fast (+3,000ì›)</option>
        <option value="standard">Standard</option>
      </select>

      <hr style="margin: 16px 0;">

      <div class="sticky">
        <h3 style="margin: 0 0 10px;">ğŸ§º ì¥ë°”êµ¬ë‹ˆ</h3>
        <div id="cartList" style="display:flex; flex-direction:column; gap:8px;"></div>
        <hr style="margin: 16px 0;">

        <div style="display:flex; flex-direction:column; gap:6px;">
          <div style="display:flex; justify-content:space-between;">
            <span>ì„ íƒê¸ˆì•¡</span><strong id="sumBase">0ì›</strong>
          </div>
          <div style="display:flex; justify-content:space-between;">
            <span>í• ì¸</span><strong id="sumDiscount">0ì›</strong>
          </div>
          <div style="display:flex; justify-content:space-between;">
            <span>ë°°ì†¡ë¹„</span><strong id="sumShipping">0ì›</strong>
          </div>
          <hr style="margin: 8px 0;">
          <div style="display:flex; justify-content:space-between; font-size:16px;">
            <span><strong>ìµœì¢…ê¸ˆì•¡</strong></span><strong id="sumFinal">0ì›</strong>
          </div>

          <button id="clearCart" type="button" style="margin-top:10px; padding:10px; border:0; border-radius:8px; cursor:pointer;">
            ì¥ë°”êµ¬ë‹ˆ ë¹„ìš°ê¸°
          </button>
          <button id="payBtn" type="button" style="margin-top:3px; padding:1px; border:0; border-radius:8px; cursor:pointer;">
            <strong style="font-size: 20px;">ê²°ì œí•˜ê¸°</strong>
          </button>
        </div>
      </div>
    </aside>
  </div>

  <script>
    // í• ì¸ ì ìš© ë‚´ìš©
    const elMembership = document.getElementById("membership");
    const elShippingOption = document.getElementById("shippingOption");
    // ì¥ë°”êµ¬ë‹ˆ ë‚´ìš©
    const elSumBase = document.getElementById("sumBase");
    const elSumDiscount = document.getElementById("sumDiscount");
    const elSumShipping = document.getElementById("sumShipping");
    const elSumFinal = document.getElementById("sumFinal");
    // ì¥ë°”êµ¬ë‹ˆ ë²„íŠ¼
    const elClearCart = document.getElementById("clearCart");
    const elPayBtn = document.getElementById("payBtn");

    const cart = new Map();
    const KRW = (n) => `${Math.round(n).toLocaleString("ko-KR")}ì›`;

    function calcBaseTotal() {
      let total = 0;
      for (const item of cart.values()) total += item.price * item.qty;
      return total;
    }

    function processOrder(baseTotal, membership, shippingOption) {
      let memberDiscount = 0;
      if (membership === "VIP") memberDiscount = baseTotal * 0.10;
      else if (membership === "Gold") memberDiscount = baseTotal * 0.05;

      const afterMember = baseTotal - memberDiscount;

      let extraDiscount = 0;
      if (afterMember >= 200000) extraDiscount = 15000;
      else if (afterMember >= 100000) extraDiscount = 5000;

      const discountTotal = memberDiscount + extraDiscount;

      const hasItem = baseTotal > 0;
      const shippingFee = (shippingOption === "fast" && hasItem) ? 3000 : 0;

      const finalTotal = Math.max(0, baseTotal - discountTotal + shippingFee);

      return { discountTotal, shippingFee, finalTotal };
    }

    function updateSummaryUI() {
      const baseTotal = calcBaseTotal();
      const membership = elMembership.value;
      const shippingOption = elShippingOption.value;

      const { discountTotal, shippingFee, finalTotal } = processOrder(baseTotal, membership, shippingOption);

      elSumBase.textContent = KRW(baseTotal);
      elSumDiscount.textContent = discountTotal > 0 ? `- ${KRW(discountTotal)}` : "0ì›";
      elSumShipping.textContent = KRW(shippingFee);
      elSumFinal.textContent = KRW(finalTotal);
    }

    function resetAll() {
      cart.clear();
      elMembership.value = "";
      elShippingOption.value = "";
      document.querySelectorAll(".orderAmount").forEach((inp) => (inp.value = ""));
      updateSummaryUI();
    }

    document.querySelectorAll(".orderForm").forEach((form) => {
      form.addEventListener("submit", (e) => {
        e.preventDefault();

        const name = form.dataset.name;
        const price = Number(form.dataset.price);
        const stock = Number(form.dataset.stock);

        const qty = Number(form.querySelector(".orderAmount").value);

        if (!Number.isFinite(qty) || qty <= 0) {
          alert("êµ¬ë§¤ ìˆ˜ëŸ‰ì„ ì˜¬ë°”ë¥´ê²Œ ì…ë ¥í•´ì£¼ì„¸ìš”. ì˜ˆ: 1, 2, 3");
          return;
        }

        const prev = cart.get(name);
        const nextQty = (prev ? prev.qty : 0) + qty;

        if (nextQty > stock) {
          alert(`ì¬ê³ ê°€ ë¶€ì¡±í•©ë‹ˆë‹¤. í˜„ì¬ ì¬ê³ : ${stock}kg`);
          return;
        }

        cart.set(name, { name, price, stock, qty: nextQty });
        form.querySelector(".orderAmount").value = "";
        updateSummaryUI();
      });
    });

    elMembership.addEventListener("change", updateSummaryUI);
    elShippingOption.addEventListener("change", updateSummaryUI);

    elClearCart.addEventListener("click", resetAll);

    elPayBtn.addEventListener("click", () => {
      const baseTotal = calcBaseTotal();
      if (baseTotal <= 0) {
        alert("ì¥ë°”êµ¬ë‹ˆê°€ ë¹„ì–´ìˆìŠµë‹ˆë‹¤.");
        return;
      }

      const membership = elMembership.value;
      const shippingOption = elShippingOption.value;
      const { finalTotal } = processOrder(baseTotal, membership, shippingOption);

      alert(`ê²°ì œê°€ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤.\nìµœì¢… ê²°ì œ ê¸ˆì•¡ì€ ${KRW(finalTotal)} ì…ë‹ˆë‹¤.`);
    });

    updateSummaryUI();
  </script>
</body>
</html>